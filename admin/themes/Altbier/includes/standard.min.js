(function(a,$){"use strict";var b=a.AC={};$(document).ready(function(){b.helper.init();b.view.init()});b.helper={Initwidth:$(window).width(),init:function(){var c=this;$("a[rel=external]").attr("target","_blank");$("input.defaultfocus:eq(0), input[autofocus]").focus();if(!c._isLocalStorage()){c.loadScript("themes/Altbier/includes/jquery.cookie.min.js")}},loadScript:function(f,e,d){var c=true,h=null,g=true;if($.isFunction(e)){h=e;c=d||c}else{c=e||c;h=d||h}$('script[type="text/javascript"]').each(function(){var i=(f!==$(this).attr("src"));return i});if(g){$.ajax({type:"GET",url:f,async:false,success:h,dataType:"script",cache:c})}else{if($.isFunction(h)){h.call(this)}}},setStorageValue:function(f,g,c){var i=this,d=new Date().getTime()+(c*24*60*60*1000),h={};try{if(i._isLocalStorage()===true){localStorage.removeItem(f);if(c!==null){h={value:g,timestamp:d}}else{h={value:g,timestamp:""}}localStorage.setItem(f,JSON.stringify(h))}else{if(c!==null){h={expires:c}}if($.fn.cookie!=="undefined"){$.cookie(f,g,h)}}}catch(e){console.log("localStorage Error: set("+f+", "+g+")");console.log(e)}},getStorageValue:function(c){var f=this,e="",d;if(f._isLocalStorage()){e=JSON.parse(localStorage.getItem(c));if(e!==null&&e.timestamp<new Date().getTime()){f.removeStorageValue(c)}else{if(e!==null){d=e.value}}}else{if($.fn.cookie!=="undefined"){d=$.cookie(c)}}return d},removeStorageValue:function(c){var d=this;if(d._isLocalStorage()){localStorage.removeItem(c)}else{$.cookie(c,null)}},equalHeight:function(d){var c=0;d.each(function(){var f=$(this),e=f.height();if(e>c){c=e}});d.height(c)},_isLocalStorage:function(){return typeof(Storage)!=="undefined"},_isMobileDevice:function(){var d=navigator.userAgent.toLowerCase(),c=/(Android|iPhone|iPad|iPod|Blackberry|Dolphin|IEMobile|WPhone|Windows Mobile|IEMobile9||IEMobile10||IEMobile11|Kindle|Mobile|MMP|MIDP|Pocket|PSP|Symbian|Smartphone|Sreo|Up.Browser|Up.Link|Vodafone|WAP|Opera Mini|Opera Tablet|Mobile|Fennec)/i;if(d.match(c)&&(("ontouchstart" in window)||(navigator.msMaxTouchPoints>0)||window.DocumentTouch&&document instanceof DocumentTouch)){return true}}};b.view={init:function(){var f=this,c=$(".toggle-button"),e=$("#ac_container"),d=$("#ac_pagemenu");c.on("click",function(g){g.preventDefault();if(e.hasClass("sidebar-on")){f._closeSidebar(e,d);f.show_submenus=false}else{f._showSidebar(e,d);f.show_submenus=true}});f.toggleSubMenu(d,50);f.showNotifications();f.setUIButtons();f.setupAlerts();f.updateDisplay();f.handleSidebar(e);$(window).resize(function(){f.handleSidebar(e);f.updateDisplay()})},handleSidebar:function(d){var c=$(window).outerWidth();if(b.helper.getStorageValue("sidebar-pref")==="sidebar-off"||c<=767){d.addClass("sidebar-off").removeClass("sidebar-on");b.view.init.show_submenus=false}else{d.addClass("sidebar-on").removeClass("sidebar-off");b.view.init.show_submenus=true}},preventSubMenu:function(c){$(c).find(".nav > span.open-nav").on("click",function(d){return true})},toggleSubMenu:function(d,c){var e=this;$(d).find(".nav  > span.open-nav").on("click",function(h){if(b.view.init.show_submenus){h.preventDefault();var j=$(this),i=j.hasClass("open-sub"),g=j.next(),f=[];if(g.is(":visible")===false){f.push(d.find("ul").slideUp(c))}d.find(".nav").removeClass("current").find("span").removeClass("open-sub");j.parent(".nav").addClass("current");if(i){f.push(g.slideToggle(c))}else{j.addClass("open-sub")}$.when.apply($,f).done(function(){e.updateDisplay()});return false}else{return true}})},showNotifications:function(){if(typeof cms_notify_all==="function"){cms_notify_all()}$(document).on("click",".close-warning",function(){$(this).parent().hide();$(this).parent().remove()});var c=$("body").attr("id")+"_notification";$(".pagewarning .close-warning").on("click",function(){b.helper.setStorageValue(c,"hidden",60)});if(b.helper.getStorageValue(c)==="hidden"){$(".pagewarning").addClass("hidden")}$(".message:not(.no-slide)").click(function(){$(".message").slideUp()});$(".message:not(.no-slide), .pageerrorcontainer:not(.no-slide), .pagemcontainer:not(.no-slide)").each(function(){var d=$(this);$(d).hide().slideDown(1000,function(){window.setTimeout(function(){d.slideUp()},10000)})});$(document).on("cms_ajax_apply",function(f){$("button[name=cancel], button[name=m1_cancel]").fadeOut();$("button[name=cancel], button[name=m1_cancel]").button("option","label",f.close);$("button[name=cancel], button[name=m1_cancel]").fadeIn();var d="";if(f.response==="Success"){d='<aside class="message pagemcontainer" role="status"><span class="close-warning xhr">Close</span><p class="pagemessage">'+f.details+"</p></aside>"}else{d='<aside class="message pageerrorcontainer" role="alert"><span class="close-warning">Close</span><ul class="pageerror">';d+=f.details;d+="</ul></aside>"}$("body").append(d).slideDown(1000,function(){window.setTimeout(function(){$(".message").slideUp();$(".message").remove()},10000)});$(document).on("click",".close-warning",function(){$(".message").slideUp();$(".message").remove()})})},setUIButtons:function(){$('input[type="submit"], :button[data-ui-icon]').each(function(){var d=$(this),e=d.data("uiIcon")||"ui-icon-circle-check",c=d.val(),f=$("<button />");if(!d.hasClass("noautobtn")||!d.hasClass("no-ui-btn")){if(d.is("[name*=apply]")){e=d.data("uiIcon")||"ui-icon-disk"}else{if(d.is("[name*=cancel]")){e=d.data("uiIcon")||"ui-icon-circle-close"}else{if(d.is("[name*=resettodefault]")||d.attr("id")==="refresh"){e=d.data("uiIcon")||"ui-icon-refresh"}}}}if(d.is(":button")){c=d.text()}$(this.attributes).each(function(g,h){f.attr(h.name,h.value)});f.button({icons:{primary:e},label:c});d.replaceWith(f)});$("a.pageback").addClass("ui-state-default ui-corner-all").prepend('<span class="ui-icon ui-icon-arrowreturnthick-1-w">').hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})},updateDisplay:function(){var d=$("#ac_menu");var e=$("#admin-alerts");var c=$("header.header");var f=c.outerHeight()+c.offset().top;if(e.length){f=e.outerHeight()+e.offset().top}if(d.outerHeight()+f<$(window).height()){}else{if(d.offset().top<$(window).scrollTop()){$("html, body").animate({scrollTop:$("#ac_menu").offset().top},1000)}}},_showSidebar:function(d,c){d.addClass("sidebar-on").removeClass("sidebar-off");c.find("li.current ul").show();b.view.init.show_submenus=true;b.helper.setStorageValue("sidebar-pref","sidebar-on",60)},_closeSidebar:function(d,c){d.removeClass("sidebar-on").addClass("sidebar-off");c.find("li ul").hide();b.view.init.show_submenus=false;b.helper.setStorageValue("sidebar-pref","sidebar-off",60)},_handleAlert:function(c){var e=$(c).closest(".alert-box");var d=e.data("alert-name");if(!d){return}return $.ajax({method:"POST",url:cms_data.ajax_alerts_url,data:{op:"delete",alert:d}}).done(function(){e.slideUp(1000);var f=e.parent();if(f.children().length<=1){e.closest("div.ui-dialog-content").dialog("close");$("#alert-noalerts").show();$("a#alerts").closest("li").remove()}e.remove()}).fail(function(h,f,g){console.debug("problem deleting an alert: "+g)})},setupAlerts:function(){var c=this;$("a#alerts").click(function(d){d.preventDefault();$("#alert-dialog").dialog()});$(".alert-msg a").click(function(d){d.preventDefault();b.view.handleAlert(d.target)});$(".alert-icon,.alert-remove").click(function(d){d.preventDefault();c._handleAlert(d.target)})}}})(this,jQuery);