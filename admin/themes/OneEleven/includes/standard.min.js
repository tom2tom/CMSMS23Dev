(function(b,c){var a=b.OE={};c(document).ready(function(){a.helper.init();a.view.init()});a.helper={init:function(){var d=this;c("a[rel=external]").attr("target","_blank");c("input.defaultfocus:eq(0), input[autofocus]").focus();if(!d._isLocalStorage()){d.loadScript("themes/OneEleven/includes/jquery.cookie.min.js")}},loadScript:function(g,f,e){var d=true,i=null,h=true;if(c.isFunction(f)){i=f;d=e||d}else{d=f||d;i=e||i}c('script[type="text/javascript"]').each(function(){var j=(g!==c(this).attr("src"));return j});if(h){c.ajax({type:"GET",url:g,async:false,success:i,dataType:"script",cache:d})}else{if(c.isFunction(i)){i.call(this)}}},setStorageValue:function(g,h,d){var j=this,e=new Date().getTime()+(d*24*60*60*1000),i={};try{if(j._isLocalStorage()===true){localStorage.removeItem(g);if(d!==null){i={value:h,timestamp:e}}else{i={value:h,timestamp:""}}localStorage.setItem(g,JSON.stringify(i))}else{if(d!==null){i={expires:d}}if(c.fn.cookie!=="undefined"){c.cookie(g,h,i)}}}catch(f){console.log("localStorage Error: set("+g+", "+h+")");console.log(f)}},getStorageValue:function(d){var g=this,f="",e;if(g._isLocalStorage()){f=JSON.parse(localStorage.getItem(d));if(f!==null&&f.timestamp<new Date().getTime()){g.removeStorageValue(d)}else{if(f!==null){e=f.value}}}else{if(c.fn.cookie!=="undefined"){e=c.cookie(d)}}return e},removeStorageValue:function(d){var e=this;if(e._isLocalStorage()){localStorage.removeItem(d)}else{c.cookie(d,null)}},equalHeight:function(f){var e=0,d;f.each(function(){var h=c(this),g=h.height();if(g>e){e=g}});f.height(e)},_isLocalStorage:function(){return typeof(Storage)!=="undefined"},_isMobileDevice:function(){var e=navigator.userAgent.toLowerCase(),d=/(Android|iPhone|iPad|iPod|Blackberry|Dolphin|IEMobile|WPhone|Windows Mobile|IEMobile9||IEMobile10||IEMobile11|Kindle|Mobile|MMP|MIDP|Pocket|PSP|Symbian|Smartphone|Sreo|Up.Browser|Up.Link|Vodafone|WAP|Opera Mini|Opera Tablet|Mobile|Fennec)/i;if(e.match(d)&&(("ontouchstart" in window)||(navigator.msMaxTouchPoints>0)||window.DocumentTouch&&document instanceof DocumentTouch)){return true}}};a.view={init:function(){var g=this,d=c(".toggle-button"),f=c("#oe_container"),e=c("#oe_pagemenu");d.on("click",function(h){h.preventDefault();if(f.hasClass("sidebar-on")){g._closeSidebar(f,e)}else{g._showSidebar(f,e)}});g.toggleSubMenu(e,50);g.showNotifications();g.setUIButtons();g.setupAlerts();g.updateDisplay();g.handleSidebar(f);c(window).resize(function(){g.handleSidebar(f);g.updateDisplay()})},handleSidebar:function(e){var d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(a.helper.getStorageValue("sidebar-pref")==="sidebar-off"||d<=768){e.addClass("sidebar-off").removeClass("sidebar-on")}else{e.addClass("sidebar-on").removeClass("sidebar-off")}},toggleSubMenu:function(e,d){var f=this;e.find("li.current span").addClass("open-sub");e.find("> li > span").click(function(){var h=c(this).next();var g=[];if(h.is(":visible")===false){g.push(e.find("ul").slideUp(d))}g.push(h.slideToggle(d));c.when.apply(c,g).done(function(){f.updateDisplay()})})},showNotifications:function(){c(".pagewarning, .message, .pageerrorcontainer, .pagemcontainer").prepend('<span class="close-warning"></span>');c(document).on("click",".close-warning",function(){c(this).parent().hide();c(this).parent().remove()});var d=c("body").attr("id")+"_notification";c(".pagewarning .close-warning").click(function(){a.helper.setStorageValue(d,"hidden",60)});if(a.helper.getStorageValue(d)==="hidden"){c(".pagewarning").addClass("hidden")}c(".message:not(.no-slide)").click(function(){c(".message").slideUp()});c(".message:not(.no-slide), .pageerrorcontainer:not(.no-slide), .pagemcontainer:not(.no-slide)").each(function(){var e=c(this);c(e).hide().slideDown(1000,function(){window.setTimeout(function(){e.slideUp()},10000)})});c(document).on("cms_ajax_apply",function(g){c("button[name=cancel], button[name=m1_cancel]").fadeOut();c("button[name=cancel], button[name=m1_cancel]").button("option","label",g.close);c("button[name=cancel], button[name=m1_cancel]").fadeIn();var f="";if(g.response==="Success"){f='<aside class="message pagemcontainer" role="status"><span class="close-warning">Close</span><p class="pagemessage">'+g.details+"</p></aside>"}else{f='<aside class="message pageerrorcontainer" role="alert"><span class="close-warning">Close</span><ul class="pageerror">';f+=g.details;f+="</ul></aside>"}c("body").append(f).slideDown(1000,function(){window.setTimeout(function(){c(".message").slideUp();c(".message").remove()},10000)});c(document).on("click",".close-warning",function(){c(".message").slideUp();c(".message").remove()})})},setUIButtons:function(){c('input[type="submit"], :button[data-ui-icon]').each(function(){var e=c(this),f=e.data("uiIcon")||"ui-icon-circle-check",d=e.val(),g=c("<button />");if(!e.hasClass("noautobtn")||!e.hasClass("no-ui-btn")){if(e.is("[name*=apply]")){f=e.data("uiIcon")||"ui-icon-disk"}else{if(e.is("[name*=cancel]")){f=e.data("uiIcon")||"ui-icon-circle-close"}else{if(e.is("[name*=resettodefault]")||e.attr("id")==="refresh"){f=e.data("uiIcon")||"ui-icon-refresh"}}}}if(e.is(":button")){d=e.text()}c(this.attributes).each(function(h,i){g.attr(i.name,i.value)});g.button({icons:{primary:f},label:d});e.replaceWith(g)});c("a.pageback").addClass("ui-state-default ui-corner-all").prepend('<span class="ui-icon ui-icon-arrowreturnthick-1-w">').hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")})},updateDisplay:function(){var e=c("#oe_menu");var f=c("#admin-alerts");var d=c("header.header");var g=d.outerHeight()+d.offset().top;if(f.length){g=f.outerHeight()+f.offset().top}if(e.outerHeight()+g<c(window).height()){e.css({position:"fixed",top:g})}else{e.css({position:"",top:""});if(e.offset().top<c(window).scrollTop()){c("html, body").animate({scrollTop:c("#oe_menu").offset().top},1000)}}},_showSidebar:function(e,d){e.addClass("sidebar-on").removeClass("sidebar-off");d.find("li.current ul").show();a.helper.setStorageValue("sidebar-pref","sidebar-on",60)},_closeSidebar:function(e,d){e.removeClass("sidebar-on").addClass("sidebar-off");d.find("li ul").hide();a.helper.setStorageValue("sidebar-pref","sidebar-off",60)},_handleAlert:function(d){var f=c(d).closest(".alert-box");var e=f.data("alert-name");if(!e){return}return c.ajax({method:"POST",url:cms_data.ajax_alerts_url,data:{op:"delete",alert:e}}).done(function(){f.slideUp(1000);var g=f.parent();if(g.children().length<=1){f.closest("div.ui-dialog-content").dialog("close");c("#alert-noalerts").show();c("a#alerts").closest("li").remove()}f.remove()}).fail(function(i,g,h){console.debug("problem deleting an alert: "+h)})},setupAlerts:function(){var d=this;c("a#alerts").click(function(e){e.preventDefault();c("#alert-dialog").dialog()});c(".alert-msg a").click(function(e){e.preventDefault();a.view.handleAlert(e.target)});c(".alert-icon,.alert-remove").click(function(e){e.preventDefault();d._handleAlert(e.target)})}}})(this,jQuery);