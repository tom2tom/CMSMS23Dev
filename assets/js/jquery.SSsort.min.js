/*!
jQuery plug-in SSsort table-sorter/pager V.0.6.1
(C) 2014-2020 Tom Phane
License: GNU Affero GPL V.3 or later
  bundled with
Metadata plugin for jQuery
(C) 2006 John Resig, Yehuda Katz, JÃ¶rn Zaefferer, Paul McLanahan
Dual licensed: MIT and GPL
*/
!function($){$.fn.metadata=function(opts){function setType(e,t){defaults.type=e,defaults.name=t}var settings=$.extend({},$.fn.metadata.defaults,opts);settings.single||(settings.single="metadata");var elem=this[0],data=$.data(elem,settings.single);if(data)return data;if(data="{}","class"==settings.type){var m=settings.cre.exec(elem.className);m&&(data=m[1])}else if("elem"==settings.type){if(!elem.getElementsByTagName)return;var e=elem.getElementsByTagName(settings.name);e.length&&(data=$.trim(e[0].innerHTML))}else if(void 0!==elem.getAttribute){var attr=elem.getAttribute(settings.name);attr&&(data=attr)}return data.indexOf("{")<0&&(data="{"+data+"}"),data=eval("("+data+")"),$.data(elem,settings.single,data),data},$.fn.metadata.defaults=$.extend({type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},$.fn.metadata.defaults||{})}(jQuery),function($){$.fn.SSsort=function(r){var o={table:null,header:null,body:null,rows:null,sortcol:null,sortdata:[],currentpage:1,pagecount:1,works:[]};return this.each(function(){var i=$.extend({},o,$.fn.SSsort.defaults,r||{});i.table=this;var c=$(this);i.header=c.children("thead"),i.body=c.children("tbody"),i.rows=i.body[0].rows,i.works=[];var d=i.header.find("tr:first > th"),u=($.fn.jquery,$.fn.metadata),f=0;if(d.each(function(){var s=$(this),a=s.hasClass("nosort");if(!a&&u&&!1===s.metadata().sss&&(a=!0),!a){var r=function(s,a){var r=!1;if($.fn.metadata){var n=$(s).metadata().sss;if(!1===n)return!1;n&&(r=function(s){var a,r=t,n=e.length,l=s.toLowerCase();for(a=r;a<n;a++)if(e[a].id.toLowerCase()===l)return e[a];for(a=0;a<r;a++)if(e[a].id.toLowerCase()===l)return e[a];return!1}(n))}if(!r){var o=s.cellIndex;r=function(s,a){var r,n,o=!1,i=a.rows,c=0;for(;!1===o&&(r=i[c]);)n=r.cells[s],""===(o=$.trim(l(n)))&&(o=!1),c++;if(!1!==o){var d,u=t,f=e.length;for(d=u;d<f;d++)if(e[d].is(o,n,a))return e[d];for(d=1;d<u;d++)if(e[d].is(o,n,a))return e[d]}return e[0]}(o,a)}return r}(this,i);r&&(i.works[f]={parser:r,dirty:!0,_map:[]},i.rows.length>1&&i.sortClass&&s.addClass(i.sortClass),s.on("click",n))}f++}),$.data(this,"SSsortcfg",i),null!==i.firstsort){var m=d.eq(i.firstsort-1),g=m.hasClass("nosort");!g&&u&&!1===m.metadata().sss&&(g=!0),g?i.firstsort=null:m.trigger("click")}null===i.firstsort&&i.paginate&&(s(i),a(0,i),i.countid&&$("#"+i.countid).html(i.pagecount))}),this},$.fn.SSsort.defaults={sortClass:null,ascClass:null,descClass:null,evenClass:null,oddClass:null,evensortClass:null,oddsortClass:null,firstsort:null,sortdesc:!1,paginate:!1,pagesize:20,currentid:null,countid:null,onSorted:null};var e=[{id:"text",is:function(e){return!0},format:function(e){return $.trim(e)},type:"text"},{id:"number",is:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},format:function(e){if(e){var t=Number(e);return isNaN(t)?Number.NEGATIVE_INFINITY:t}return(e+"").length>0?0:Number.POSITIVE_INFINITY},type:"numeric"},{id:"isoDate",is:function(e){return/^[12]\d{3}[\/-][01]\d[\/-]\[0-3]\d$/.test(e)},format:function(e){return Date.parse(e.replace(/-/g,"/"))},type:"numeric"}],t=e.length;function s(e){e.pagecount=1+(e.rows.length/e.pagesize|0)}function a(e,t){var s=parseInt(t.pagesize,10);t.currentid&&(t.currentpage=s<1?1:1+(e/s|0),$("#"+t.currentid).html(t.currentpage));var a=t.rows;s<1&&(s=a.length+1);var r,n,l=e+s;for(r=0,n=a.length;r<n;r++)a[r].style.display=r>=e&&r<l?"":"none"}function r(e){var t,s,a,r=e.works[e.sortcol],n=r.parser.format,o=e.rows,i=o.length,c=e.sortcol,d=[];for(s=0;s<i;s++)t=o[s].cells[c],d[s]=[n(l(t),t,e),s];a="text"===r.parser.type?e.sortdesc?function(e,t){return t[0].localeCompare(e[0])}:function(e,t){return e[0].localeCompare(t[0])}:e.sortdesc?function(e,t){return t[0]-e[0]}:function(e,t){return e[0]-t[0]},r._map=d.sort(a)}function n(e){var t=$(this).closest("table"),n=$.data(t[0],"SSsortcfg");if(!(n.rows.length<2)){var l,o=this.cellIndex,i=n.header.find("tr:first > th"),c=0;if(o>0)for(l=0;l<o;l++){var d=i[l];if(d.hasAttribute("colspan")){var u=d.getAttribute("colspan");c+=parseInt(u,10)||1}else c++}var f,m,g=null;c===n.sortcol?(f=n.sortdesc?n.descClass:n.ascClass,n.sortdesc=!n.sortdesc,m=n.sortdesc?n.descClass:n.ascClass,f&&i.eq(c).removeClass(f),m&&i.eq(c).addClass(m),$(n.table).trigger("beforetablesort",{column:c,direction:n.sortdesc}),n.works[c].dirty?r(n):n.works[c]._map.reverse()):(null!==n.sortcol?(g=n.sortcol,(f=n.sortdesc?n.descClass:n.ascClass)&&i.eq(g).removeClass(f),n.sortClass&&(i.eq(c).removeClass(n.sortClass),i.eq(g).addClass(n.sortClass)),n.ascClass&&i.eq(c).addClass(n.ascClass),n.sortdesc=!1):(n.sortClass&&i.eq(c).removeClass(n.sortClass),(m=n.sortdesc?n.descClass:n.ascClass)&&i.eq(c).addClass(m)),n.sortcol=c,$(n.table).trigger("beforetablesort",{column:c,direction:n.sortdesc}),r(n)),setTimeout(function(){var e,t,r,l,o,i=!!n.oddClass&&new RegExp("(^|\\s+)"+n.oddClass+"(?!\\S)"),u=!!n.evenClass&&new RegExp("(^|\\s+)"+n.evenClass+"(?!\\S)"),f=!!n.oddClass&&new RegExp("(^|\\s+)"+n.oddsortClass+"(?!\\S)"),m=!!n.evenClass&&new RegExp("(^|\\s+)"+n.evensortClass+"(?!\\S)"),h=n.body[0],p=h.parentNode,v=h.nextSibling,C=n.rows,N=C.length,b=n.works[c]._map;for(p.removeChild(h),r=0;r<N;r++)for(e=C[l=b[r][1]],d=e.cells[c],h.appendChild(e),r%2?(i&&(e.className=e.className.replace(i,"")),u&&!e.className.match(u)&&(e.className=e.className+" "+n.evenClass),f&&(d.className=d.className.replace(f,"")),m&&!d.className.match(m)&&(d.className=d.className+" "+n.evensortClass)):(u&&(e.className=e.className.replace(u,"")),i&&!e.className.match(i)&&(e.className=e.className+" "+n.oddClass),m&&(d.className=d.className.replace(m,"")),f&&!d.className.match(f)&&(d.className=d.className+" "+n.oddsortClass)),null!==g&&(t=e.cells[g],f&&(t.className=t.className.replace(f,"")),m&&(t.className=t.className.replace(m,""))),b[r][1]=r,o=r+1;o<N;o++)b[o][1]>l&&b[o][1]--;p.insertBefore(h,v),n.body=$(n.table).children("tbody"),n.rows=h.rows,n.works[c].dirty=void 0!==n.works[c].parser.watch&&n.works[c].parser.watch,n.paginate&&(n.currentpage=1,s(n),a(0,n),n.countid&&$("#"+n.countid).html(n.pagecount)),$(n.table).trigger("aftertablesort",{column:c,direction:n.sortdesc}),$.isFunction(n.onSorted)&&n.onSorted.call(n.table)},20)}}function l(e){for(;e.hasChildNodes();)e=e.firstChild;var t=e.nodeValue;return"#text"===e.nodeName&&""===$.trim(t)&&null!==(e=e.nextElementSibling)&&(t=e.nodeValue),t||!1}$.fn.SSsort.movePage=function(e,t,s){var r=$.data(e,"SSsortcfg");if(r){var n=t?s?r.pagecount:r.currentpage+1:s?1:r.currentpage-1;n>0&&n<=r.pagecount&&(r.currentpage=n,a((n-1)*r.pagesize,r))}},$.fn.SSsort.setCurrent=function(e,t,r){var n=$.data(e,"SSsortcfg");if(n){n[t]=r,n.countid&&s(n);var l=0;"currentpage"===t&&r>0&&(l=r-1),a(l,n),n.countid&&$("#"+n.countid).html(n.pagecount)}},$.fn.SSsort.mapTable=function(e){var t={},s=1;return $(e).find("tr").each(function(){var e=this.getAttribute("id")||this.getAttribute("name")||"row"+s,a={},r=1;$(this).each(function(){var e=[];$(this).children().each(function(){e[e.length]=this.hasAttribute("value")?this.getAttribute("value"):$(this).text()});var t=this.getAttribute("id")||this.getAttribute("name")||"col"+r;switch(e.length){case 0:a[t]="<empty>";break;case 1:a[t]=e[0];break;default:var s,n,l={};for(s=0,n=e.length;s<n;s++)l[s]=e[s];a[t]=l}r++}),t[e]=a,s++}),t},$.fn.SSsort.addParser=function(t,s){var a,r=e.length,n=t.id.toLowerCase();for(a=0;a<r;a++)if(e[a].id.toLowerCase()===n)return void(s&&(e[a]=t));e[r]=t},$.fn.SSsort.formatFloat=function(e){var t=parseFloat(e);return isNaN(t)?Number.NEGATIVE_INFINITY:t},$.fn.SSsort.formatInt=function(e){var t=parseInt(e,10);return isNaN(t)?Number.NEGATIVE_INFINITY:t}}(jQuery);